# Component Definition: Operating Cash Flow
# Cash generated from core business operations

component_id: operating_cash_flow
display_name: "Operating Cash Flow"
description: "Net cash provided by (used in) operating activities. Cash generated from core business operations."

category: cash_flow
subcategory: operations

characteristics:
  balance_type: debit
  period_type: duration
  is_monetary: true
  is_abstract: false
  data_type: monetary

matching_rules:
  label_rules:
    # Highest priority: Exact matches
    - patterns:
        - "Net Cash Provided by Operating Activities"
        - "Cash Flows from Operating Activities"
        - "Net Cash from Operating Activities"
        - "Operating Cash Flow"
        - "Cash from Operations"
        - "Net Cash Provided by (Used in) Operating Activities"
      match_type: exact
      case_sensitive: false
      weight: 20

    # High weight for contains patterns
    - patterns:
        - "cash from operating"
        - "cash provided by operating"
        - "operating activities"
        - "cash flows from operations"
        - "net cash operating"
      match_type: contains
      case_sensitive: false
      weight: 12

  local_name_rules:
    - patterns:
        - "NetCashProvidedByUsedInOperatingActivities"
        - "CashFlowsFromUsedInOperatingActivities"
      match_type: exact
      weight: 15

    - patterns:
        - "CashProvidedByOperating"
        - "CashFromOperating"
        - "OperatingActivities"
        - "NetCashGeneratedFromOperations"
        - "CashFlowsFromUsedInOperating"
      match_type: contains
      weight: 10

  hierarchy_rules:
    # Should be summary line of operating section
    - rule_type: depth_level
      pattern: "1-3"
      weight: 5

  calculation_rules:
    # Should have adjustments as children
    - rule_type: has_children
      patterns:
        - "*Depreciation*"
        - "*WorkingCapital*"
        - "*Adjustments*"
      min_matches: 1
      weight: 8

  definition_rules:
    - keywords:
        - "operating"
        - "cash flow"
        - "core operations"
        - "business activities"
      all_required: false
      weight: 4

scoring:
  min_score: 18
  confidence_levels:
    high: 32
    medium: 25
    low: 18
  tiebreaker: highest_in_hierarchy
  reject_if:
    - condition: "Is abstract concept"
      pattern: "abstract=true"
    - condition: "Is investing activities"
      pattern: "name~investing"
    - condition: "Is financing activities"
      pattern: "name~financing"
    - condition: "Is working capital change"
      pattern: "name~workingcapital"
    - condition: "Is individual adjustment"
      pattern: "name~adjustments"

    # Reject disclosure items
    - condition: "Is text block"
      pattern: "name~textblock"
    - condition: "Is schedule"
      pattern: "name~schedule"
    - condition: "Is table"
      pattern: "name~table"

composition:
  is_composite: false

validation:
  expected_sign: either
  required_for:
    - free_cash_flow
    - operating_cash_ratio
    - cash_flow_margin
